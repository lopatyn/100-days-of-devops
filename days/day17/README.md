# –î–µ–Ω—å 17: –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è PostgreSQL üêòÔøΩ

> **Hook:** –î–∞–Ω—ñ ‚Äî —Ü–µ —Å–µ—Ä—Ü–µ –±—É–¥—å-—è–∫–æ–≥–æ —Å—É—á–∞—Å–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É. –ê–ª–µ —è–∫ –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä—Ü—è —Ç–∞–∫, —â–æ–± –Ω–µ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –ø—ñ–¥ –∑–∞–≥—Ä–æ–∑—É –≤–µ—Å—å –æ—Ä–≥–∞–Ω—ñ–∑–º? üíìüõ°Ô∏è
>
> **Problem-Solution-Value:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∞–±–æ –±–∞–∑ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ —Å—Ç–≤–æ—Ä—é—î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–ª—è –≤–∏—Ç–æ–∫—É –¥–∞–Ω–∏—Ö. –ú–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ PostgreSQL –∑ —á—ñ—Ç–∫–∏–º —Ä–æ–∑–º–µ–∂—É–≤–∞–Ω–Ω—è–º –¥–æ—Å—Ç—É–ø—É: –æ–∫—Ä–µ–º–∞ –±–∞–∑–∞ `kodekloud_db6` —Ç–∞ –≤–∏–¥—ñ–ª–µ–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á `kodekloud_roy` –∑ –æ–±–º–µ–∂–µ–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏. –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î **—Å–∏–ª—å–Ω—É —ñ–∑–æ–ª—è—Ü—ñ—é (Tenant Isolation)** —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–ø–µ–∫–∏ Stratos DC.
>
> **Call to Action:** –ü–æ–±—É–¥—É–π –Ω–∞–¥—ñ–π–Ω—É —Ñ–æ—Ä—Ç–µ—Ü—é –¥–ª—è —Å–≤–æ—ó—Ö –¥–∞–Ω–∏—Ö. –ì–∞–π–¥ –ø–æ SecOps –¥–ª—è –±–∞–∑ –¥–∞–Ω–∏—Ö –Ω–∏–∂—á–µ! üëá

## –ë—ñ–∑–Ω–µ—Å —Ç–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

### –ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ:
–ë–∞–∑–∏ –¥–∞–Ω–∏—Ö —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—é —á–∞—Å—Ç–∏–Ω–æ—é **Infrastructure Compatibility**. –î–ª—è –±—ñ–∑–Ω–µ—Å—É –ø—Ä–∞–≤–∏–ª—å–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è DB –æ–∑–Ω–∞—á–∞—î —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö —Ç–∞ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–º—É –¥–æ—Å—Ç—É–ø—É. –£ –≤–µ–ª–∏–∫–∏—Ö –∫–æ–º–ø–∞–Ω—ñ—è—Ö, —è–∫ Nautilus, —Ü–µ —Ç–∞–∫–æ–∂ –ø—Ä–æ **Audit Compliance** ‚Äî –∫–æ–∂–µ–Ω –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –º–∞—î —Å–≤–æ–≥–æ "–≤–ª–∞—Å–Ω–∏–∫–∞" –≤ –ë–î –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω —Ç–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –≤–∏—Ç—Ä–∞—Ç (FinOps):
- **On-premise:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö Nautilus –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø—ñ–¥–Ω—ñ–º–∞—Ç–∏ –Ω–æ–≤—ñ —ñ–Ω—Å—Ç–∞–Ω—Å–∏.
- **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:** PostgreSQL –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä–µ—Å—É—Ä—Å–∏, –¥–æ–∑–≤–æ–ª—è—é—á–∏ —Å–æ—Ç–Ω—ñ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –ë–î –Ω–∞ –æ–¥–Ω–æ–º—É –ø–æ—Ç—É–∂–Ω–æ–º—É —Ö–æ—Å—Ç—ñ.

### –û–ø–µ—Ä–∞—Ü—ñ–π–Ω–∞ –æ–±–ª–∞—Å—Ç—å:
- **–°–µ—Ä–µ–¥–æ–≤–∏—â–µ:** On-premise / Stratos Data Center.
- **–†—ñ–≤–µ–Ω—å:** Data Layer (–†—ñ–≤–µ–Ω—å –¥–∞–Ω–∏—Ö).
- **–ï—Ç–∞–ø:** Setup & Access Management.

### –†–∏–∑–∏–∫–∏:
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (`postgres`) –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ñ—á–Ω–∏—Ö –Ω–∞—Å–ª—ñ–¥–∫—ñ–≤ –ø—Ä–∏ –∑–ª–æ–º—ñ (Privilege Escalation). –¢–∞–∫–æ–∂, –±–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –ø—Ä–∞–≤, –æ–¥–∏–Ω –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –º–æ–∂–µ –≤–∏–ø–∞–¥–∫–æ–≤–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –¥–∞–Ω—ñ —ñ–Ω—à–æ–≥–æ.

## –†–æ–∑–±—ñ—Ä –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏: PostgreSQL Account Management

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ (–î–æ—Å—Ç—É–ø –¥–æ –¥–∞–Ω–∏—Ö)
–°—Ö–µ–º–∞ –ø–æ–∫–∞–∑—É—î —ñ–∑–æ–ª—è—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–µ–≥–º–µ–Ω—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞.

![PostgreSQL Architecture Day 17](postgres_architecture.png)

### –ü–æ–∫—Ä–æ–∫–æ–≤–µ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –í—Ö—ñ–¥ —É –∫–æ–Ω—Å–æ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è
–ú–∏ –ø—Ä–∞—Ü—é—î–º–æ –≤—ñ–¥ —ñ–º–µ–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `postgres` –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É —Å–µ—Ä–≤—ñ—Å—É.
```bash
# –í—Ö–æ–¥–∏–º–æ –≤ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω–∞–ª PostgreSQL
sudo -u postgres psql
```
**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –¥–æ –≤–≤–æ–¥—É `postgres=#`.

### –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
–ú–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ä–æ–ª—å –∑ –ø—Ä–∞–≤–æ–º –≤—Ö–æ–¥—É —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å–∫–ª–∞–¥–Ω–∏–π –ø–∞—Ä–æ–ª—å.
```sql
-- –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–≥—ñ–¥–Ω–æ –∑ –≤–∏–º–æ–≥–∞–º–∏ Nautilus DevOps
CREATE USER kodekloud_roy WITH PASSWORD 'dCV3szSGNA';
```
**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `CREATE ROLE`.
**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** –ö–æ–º–∞–Ω–¥–∞ `\du` –º–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏ —Ä–æ–ª—å `kodekloud_roy`.

### –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏–¥—ñ–ª–µ–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
```sql
-- –°—Ç–≤–æ—Ä—é—î–º–æ –ë–î –¥–ª—è –Ω–æ–≤–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
CREATE DATABASE kodekloud_db6;
```
**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `CREATE DATABASE`.

### –ö—Ä–æ–∫ 4: –ù–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É (Granting Privileges)
```sql
-- –ù–∞–¥–∞—î–º–æ –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –±–∞–∑–∏
GRANT ALL PRIVILEGES ON DATABASE kodekloud_db6 TO kodekloud_roy;
```
**–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `GRANT`.
**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:** `\l` –ø–æ–∫–∞–∑—É—î –≤–ª–∞—Å–Ω–∏–∫–∞ —Ç–∞ –ø—Ä–∞–≤–∞ –¥–ª—è `kodekloud_db6`.

## DevOps –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏
- **Cloud Native:** –í AWS –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ **Amazon RDS** –∞–±–æ **Aurora**, –¥–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ —á–∞—Å—Ç–æ —ñ–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –∑ **IAM Database Authentication** –¥–ª—è –±–µ–∑–ø–∞—Ä–æ–ª—å–Ω–æ–≥–æ –≤—Ö–æ–¥—É.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è:** –£ Kubernetes –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —á–∞—Å—Ç–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ **Operators** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Zalando –∞–±–æ CrunchyData), —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—é—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ Custom Resources.
- **IaaC:** –í —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —Ü—ñ –¥—ñ—ó –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ Terraform –ø—Ä–æ–≤–∞–π–¥–µ—Ä `postgresql` –∞–±–æ Ansible –º–æ–¥—É–ª—ñ `postgresql_user` —Ç–∞ `postgresql_db`.

## –ü–∞—Å—Ç–∫–∏ –¥–ª—è –¥–∂—É–Ω—ñ–≤ (–ü–æ—à–∏—Ä–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏ ‚ö†Ô∏è)
- **–ü–∞—Ä–æ–ª—ñ –≤ CLI:** –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–æ–ª—è –ø—Ä—è–º–æ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º—É —Ä—è–¥–∫—É `psql -c "..."` ‚Äî –ø–∞—Ä–æ–ª—å –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ `history`. –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º –∞–±–æ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è.
- **–ó–∞–±—É—Ç—ñ –∫–æ–º–∏:** SQL —á—É—Ç–ª–∏–≤–∏–π –¥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É, –∫–æ–∂–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –º–∞—î –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è `;`.
- **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤—ñ—Å—É:** –ù–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏–π `restart` –º–æ–∂–µ –æ–±—ñ—Ä–≤–∞—Ç–∏ —Å–µ—Å—ñ—ó —ñ–Ω—à–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ —Ü—å–æ–º—É –∂ —Å–µ—Ä–≤–µ—Ä—ñ.

## –†–µ–∑—é–º–µ –¥–ª—è —Å–ø—ñ–≤–±–µ—Å—ñ–¥–∏ (Best Practices)
1. **Least Privilege:** –ù—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `SUPERUSER` –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤. –õ–∏—à–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø—Ä–∞–≤–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –ë–î/—Å—Ö–µ–º—É.
2. **Reload vs Restart:** –ó–º—ñ–Ω–∏ –≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞—Ö —Ç–∞ –ø—Ä–∞–≤–∞—Ö –≤ PG –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –Ω–∞–≤—ñ—Ç—å —Ä–µ–ª–æ–∞–¥—É, –≤–æ–Ω–∏ –∞–∫—Ç–∏–≤–Ω—ñ –º–∏—Ç—Ç—î–≤–æ.
3. **Secrets Management:** –ü–∞—Ä–æ–ª—ñ –º–∞—é—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –≤ HashiCorp Vault –∞–±–æ AWS Secrets Manager, –∞ –Ω–µ –≤ –∫–æ–¥—ñ —á–∏ —Å–∫—Ä–∏–ø—Ç–∞—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è.
4. **Owner-based Access:** –ó–∞–∑–≤–∏—á–∞–π –∫—Ä–∞—â–µ —Ä–æ–±–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –≤–ª–∞—Å–Ω–∏–∫–æ–º (`OWNER`) –π–æ–≥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
5. **White Hat Insight:** –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º PostgreSQL –º–æ–∂–µ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ –±–µ–∑ SSL. –ó–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ `pg_hba.conf` –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–ø–µ–∫–∏. [–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ –ø—Ä–æ —Ä–æ–ª—ñ –≤ Deep Dive](./DEEP_DIVE_POSTGRES_ROLES.md).

---
**–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –¥–µ–Ω—å:** [–î–µ–Ω—å 16: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Nginx —è–∫ LBR](../day16)
